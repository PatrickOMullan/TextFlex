{% extends "findbooks/base.html" %}
{% block content %}
    {% if user.is_authenticated %}
    <script type="text/javascript">

        class courseInfo {
            constructor(dept, number, section, term, year, title, isbn, image, links) {
                this.dept = dept.toString();
                this.number = number.toString();
                this.section = section.toString();
                this.term = term.toString();
                this.year = year.toString();
                this.title = title.toString();
                this.isbn = isbn.toString();
                this.links = links.toString();
                if(image != null) {
                    this.image = image.toString();
                }
                else {
                    this.image = '/media/default.jpg';
                }
            }
        }


        var course_list = []
        var index = 0



        function updateCourse(direction) {
            var img = document.getElementById("bookImg");
            var coursename = document.getElementById("CourseName");
            var isbn = document.getElementById("ISBN");
            var title = document.getElementById("BookTitle");
            var seller1 = document.getElementById("Sell1");
            var seller2 = document.getElementById("Sell2");
            var seller3 = document.getElementById("Sell3");
            var price1 = document.getElementById("Price1");
            var price2 = document.getElementById("Price2");
            var price3 = document.getElementById("Price3");
            var link1 = document.getElementById("Link1");
            var link2 = document.getElementById("Link2");
            var link3 = document.getElementById("Link3");
            if(direction == 1) { //forward
                if(index == (course_list.length - 1)) {
                    index = 0;
                }
                else {
                    index++;
                }
                img.src = course_list[index].image;
                coursename.innerHTML = course_list[index].dept + " " + course_list[index].number + " " + course_list[index].section;
                title.innerHTML = course_list[index].title;
                isbn.innerHTML = course_list[index].isbn;
                //seller1.innerHTML = course_list[index].links[0];
                //seller2.innerHTML = course_list[index].links[1];
                //seller3.innerHTML = course_list[index].links[2];
                //price1.innerHTML = course_list[index].links[0];
                //price2.innerHTML = course_list[index].links[1];
                //price3.innerHTML = course_list[index].links[2];
                link1.href = course_list[index].links;
            }
            else if(direction == 0) { //backward
                if(index == 0) {
                    index = course_list.length - 1;
                }
                else {
                    index--;
                }
                img.src = course_list[index].image;
                coursename.innerHTML = course_list[index].dept + " " + course_list[index].number + " " + course_list[index].section;
                title.innerHTML = course_list[index].title;
                isbn.innerHTML = "ISBN-13: " + course_list[0].isbn;
                //seller1.innerHTML = course_list[index].links[0];
                //seller2.innerHTML = course_list[index].links[1];
                //seller3.innerHTML = course_list[index].links[2];
                //price1.innerHTML = course_list[index].links[0];
                //price2.innerHTML = course_list[index].links[1];
                //price3.innerHTML = course_list[index].links[2];
                link1.href = course_list[index].links;
            }
        }
        
        function load_initial() {
            var img = document.getElementById("bookImg");
            var coursename = document.getElementById("CourseName");
            var title = document.getElementById("BookTitle");
            var isbn = document.getElementById("ISBN");
            var seller1 = document.getElementById("Sell1");
            var seller2 = document.getElementById("Sell2");
            var seller3 = document.getElementById("Sell3");
            var price1 = document.getElementById("Price1");
            var price2 = document.getElementById("Price2");
            var price3 = document.getElementById("Price3");
            var link1 = document.getElementById("Link1");
            var link2 = document.getElementById("Link2");
            var link3 = document.getElementById("Link3");
            img.src = course_list[0].image;
            coursename.innerHTML = course_list[0].dept + " " + course_list[0].number + " " + course_list[index].section;
            title.innerHTML = course_list[0].title;
            isbn.innerHTML = "ISBN-13: " + course_list[0].isbn;
            //seller1.innerHTML = course_list[0].links[0];
            //seller2.innerHTML = course_list[0].links[1];
            //seller3.innerHTML = course_list[0].links[2];
            //price1.innerHTML = course_list[0].links[0];
            //price2.innerHTML = course_list[0].links[1];
            //price3.innerHTML = course_list[0].links[2];
            link1.href = course_list[0].links;
        }

        function loadCourses(books) {
            for(var i = 0; i < books.length; i++) {
                const obj = JSON.parse(books[i])
                a_course = new courseInfo(obj.dept, obj.number, obj.section, obj.term, obj.year, obj.title, obj.isbn, obj.image, obj.links)
                course_list.push(a_course)
            }

            load_initial()
        }
    </script>

        <body onload="loadCourses({{ books }})">
        <div class="book-result" style="display: block; padding-top: 5%; margin: auto; text-align: center; width: 50%;">
            <h1 style="font-weight: bolder; color: rgb(172, 43, 55); font-size: 48px; padding-bottom: 5%;">TEXTBOOKS</h1>
            <div class="col-auto mb-3">
              <div class="card text-white mb-3 book-result-card" style="width: 100%; background-color: #A9B0B7;">
                <h4 id="CourseName" class="card-title" style="font-weight: bolder; font-size: 40px; color: rgb(172, 43, 55); padding-top: 5%"></h4>
                <img id="bookImg" class="card-img-top" src="#" style="width: 30%; display: block; margin-left:auto; margin-right: auto; margin-top: 5%;"/>
                <h5 id="BookTitle" style="font-weight: bolder; font-size: 20px; color: rgb(172, 43, 55); padding-top: 5%"></h5>
                <h5 id="ISBN" style="font-weight: bolder; font-size: 12px; color: rgb(172, 43, 55);"></h5>
                <div class="card-body" style="text-align:center;">
                  <table class="table" style="width: 100%;">
                      <thead>
                        <tr>
                          <th scope="col">Seller</th>
                          <th scope="col">Price</th>
                          <th scope="col">Link</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td id="Sell1"></td>
                          <td id="Price1"></td>
                          <td><a id="Link1" href="#" target="_blank"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                            </svg></a></td>
                        </tr>
                        <tr>
                          <td id="Sell2"></td>
                          <td id="Price2"></td>
                          <td><a id="Link2" href="#" target="_blank"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                            </svg></a></td>
                        </tr>
                        <tr>
                          <td id="Sell3"></td>
                          <td id="Price3"></td>
                          <td><a id="Link3" href="#" target="_blank"><svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cart" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                              <path fill-rule="evenodd" d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l1.313 7h8.17l1.313-7H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm7 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2z"/>
                            </svg></a></td>
                        </tr>
                      </tbody>
                    </table>
                  <div>
                      <button class="btn btn-primary" style="background-color:rgb(172, 43, 55); color: white; border-style: none; font-weight: bold; float: left;" onclick="updateCourse(0)">Previous</button>
                      <button class="btn btn-primary" style="background-color:rgb(172, 43, 55); color: white; border-style: none; font-weight: bold; float: right;" onclick="updateCourse(1)">Next</button>
                  </div>
                  </div>
              </div>
          </div>
        </body>
        
        
    {% else %}
        <h1>SIGN IN PLEASE</h1>
    {% endif %}
{% endblock content %}